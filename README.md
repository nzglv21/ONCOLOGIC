# RAG-проверка плана лечения (Breast Cancer) по клиническим рекомендациям и веб-источникам

Этот репозиторий содержит ноутбук main.ipynb, который собирает базу знаний из:
- локального PDF (клинические рекомендации/документ),
- набора веб-страниц и PDF-гайдлайнов (скачивание по URL),

затем строит векторный индекс FAISS на эмбеддингах HuggingFace и использует OpenAI GPT (gpt-4o) для проверки предоставленного врачом плана лечения/анамнеза на соответствие источникам.

> ⚠️ Важно: ноутбук предназначен для демонстрации подхода (RAG + LLM) и не является медицинским изделием. Результаты требуют клинической валидации.

---

## Что делает ноутбук

1. Устанавливает зависимости (через `requirements.txt`).
2. Загружает локальный PDF КР379_4.pdf через PyPDFLoader.
3. Делит документы на чанки RecursiveCharacterTextSplitter.
4. Скачивает и ингестит список источников WEB_URLS:
   - если URL заканчивается на .pdf — скачивает и парсит как PDF,
   - иначе скачивает HTML как текст (как есть).
5. Строит FAISS-индекс по эмбеддингам:
   - sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2 (нормализация эмбеддингов, cosine distance).
6. Для входного текста (анамнез/план лечения) делает retrieval (MMR) и формирует промпт:
   - “используй только документы, не придумывай факты”.
7. Возвращает ответ модели gpt-4o (через `langchain-openai`).

---

## Состав репозитория

- main.ipynb — основной ноутбук (весь пайплайн от загрузки до ответа).
- requirements.txt — зависимости (создается/используется в ноутбуке).
- КР379_4.pdf — обязательный локальный PDF, используемый для базы знаний (положите рядом с ноутбуком).

---

## Требования

- Python 3.10+ (рекомендуется 3.11)
- Доступ в интернет (для скачивания источников из `WEB_URLS`)
- OpenAI API key (для вызова `gpt-4o`)

---

## Быстрый старт (локально)

### 1) Клонирование и окружение
```bash
git clone <your-repo-url>
cd <your-repo-folder>

python -m venv .venv
# Linux/Mac
source .venv/bin/activate
# Windows (PowerShell)
# .\.venv\Scripts\Activate.ps1